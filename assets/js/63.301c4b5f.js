(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{391:function(s,n,e){"use strict";e.r(n);var a=e(3),t=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),e("p",[s._v("我们都知道，redis 的配置文件中，默认绑定接口是 127.0.0.1，也就是本地回环接口，所以是无法从外网连接 redis 服务的。如果想要让外网也能连接使用服务器上的 redis 服务，可以简单地注释掉 bind 这一行。但对于 bind 参数的作用，网上有很多文章的解释都是误人子弟的。")]),s._v(" "),e("h2",{attrs:{id:"关于bind"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关于bind"}},[s._v("#")]),s._v(" 关于bind")]),s._v(" "),e("p",[s._v("翻看网上的文章，此处多翻译为：")]),s._v(" "),e("blockquote",[e("p",[s._v("指定 redis 只接收来自于该 IP 地址的请求，如果不进行设置，那么将处理所有请求，在生产环境中最好设置该项。")])]),s._v(" "),e("p",[s._v("这种解释会搞糊涂初学者，甚至是错误的。查看配置文件 "),e("code",[s._v("redis.conf")]),s._v("，可以看到很详细的注释说明。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# By default, if no "bind" configuration directive is specified, Redis listens')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for connections from all the network interfaces available on the server.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# It is possible to listen to just one or multiple selected interfaces using")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# the "bind" configuration directive, followed by one or more IP addresses.')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Examples:")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bind 192.168.1.100 10.0.0.1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bind 127.0.0.1 ::1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# internet, binding to all the interfaces is dangerous and will expose the")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# instance to everybody on the internet. So by default we uncomment the")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# following bind directive, that will force Redis to listen only into")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the IPv4 lookback interface address (this means Redis will be able to")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# accept connections only from clients running into the same computer it")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# is running).")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# JUST COMMENT THE FOLLOWING LINE.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("p",[s._v("翻译过来的意思就是：")]),s._v(" "),e("p",[s._v("默认情况下，如果没有指定"),e("code",[s._v("bind")]),s._v("配置指令，则 Redis 监听来自服务器上所有可用网络接口的连接。可以使用"),e("code",[s._v("bind")]),s._v("配置指令来监听一个或多个选定的接口，在"),e("code",[s._v("bind")]),s._v("后拼接一个或多个 IP 地址即可。例如：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.100 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0.1\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 ::1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[e("strong",[s._v("警告")]),s._v("：如果运行 Redis 的计算机直接暴露在互联网上，绑定到所有的接口是很危险的，并会将实例暴露给互联网上的每个人。因此，默认情况下，我们取消注释以下绑定指令，这将强制 Redis 只监听 IPv4 回环接口地址（这意味着 Redis 只接受来自运行它的计算机上的客户端的连接）。")]),s._v(" "),e("p",[s._v("如果你确定希望你的实例能够监听所有的接口，只需要注释下面的这一行即可。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"网络接口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#网络接口"}},[s._v("#")]),s._v(" 网络接口")]),s._v(" "),e("p",[s._v("注释说明 bind 的是 network interfaces，即网络接口（网卡）。服务器可以有一个或者多个网络接口。可以使用 ifconfig 查看当前 Linux 服务器上的网络接口。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\ndocker0   Link encap:Ethernet  HWaddr 3A:F3:20:12:AE:6A\n          inet addr:192.168.42.1  Bcast:0.0.0.0  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:362879 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:894703 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:28218097 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("26.9")]),s._v(" MiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  TX bytes:1326305089 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(" GiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\neth0      Link encap:Ethernet  HWaddr 00:16:3E:08:18:35\n          inet addr:10.25.102.37  Bcast:10.25.103.255  Mask:255.255.252.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:4958304 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:2766733 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:534516269 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("509.7")]),s._v(" MiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  TX bytes:13382719049 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.4")]),s._v(" GiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\neth1      Link encap:Ethernet  HWaddr 00:16:3E:08:13:6B\n          inet addr:120.76.207.187  Bcast:120.76.207.255  Mask:255.255.252.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:13183600 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:14070363 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:6460933699 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.0")]),s._v(" GiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  TX bytes:8462002985 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.8")]),s._v(" GiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:156288093 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:156288093 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:19039024606 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("17.7")]),s._v(" GiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  TX bytes:19039024606 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("17.7")]),s._v(" GiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nveth802443e Link encap:Ethernet  HWaddr "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(":E8:12:D0:88:96\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:120 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:162 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:44625 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("43.5")]),s._v(" KiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  TX bytes:18533 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.0")]),s._v(" KiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br")])]),e("p",[s._v("我的服务器是阿里云的ECS，当前有5个网络接口。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("网络接口")]),s._v(" "),e("th",[s._v("说明")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("docker0")]),s._v(" "),e("td",[s._v("安装 docker 时自动创建的网桥")])]),s._v(" "),e("tr",[e("td",[s._v("eth0")]),s._v(" "),e("td",[s._v("阿里云内网接口")])]),s._v(" "),e("tr",[e("td",[s._v("eth1")]),s._v(" "),e("td",[s._v("阿里云公网接口")])]),s._v(" "),e("tr",[e("td",[s._v("lo")]),s._v(" "),e("td",[s._v("本地回环接口")])]),s._v(" "),e("tr",[e("td",[s._v("veth88f3e3c")]),s._v(" "),e("td",[s._v("运行 docker 容器创建的 veth pair 的一端")])])])]),s._v(" "),e("p",[s._v("所以，如果要让公网可以连接该服务器上的 redis 服务，除了直接注释掉 bind 这一行来绑定到所有的网络接口之外，更正确的做法应该是不注释，再绑定多 eth1 这个公网接口，地址是 120.76.207.187。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("120.76")]),s._v(".207.187\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("然后重启下 redis 服务即可，这样配置，Redis 就只监听 IPv4 的本地回环接口和公网接口。")]),s._v(" "),e("h2",{attrs:{id:"连接docker容器中的redis"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#连接docker容器中的redis"}},[s._v("#")]),s._v(" 连接Docker容器中的Redis")]),s._v(" "),e("p",[s._v("如果在 docker 容器里运行 redis 服务，可以在 "),e("code",[s._v("run")]),s._v(" 的时候使用 "),e("code",[s._v("-p")]),s._v(" 端口映射，比如：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ docker run -ti -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v(":6379 centos:7 /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("然后到容器里，查看网络接口。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\neth0      Link encap:Ethernet  HWaddr 02:42:C0:A8:2A:03\n          inet addr:192.168.42.3  Bcast:0.0.0.0  Mask:255.255.255.0\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:162 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:120 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:18533 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.0")]),s._v(" KiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  TX bytes:44625 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("43.5")]),s._v(" KiB"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          \nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0\n          RX bytes:0 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" b"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  TX bytes:0 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" b"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("p",[s._v("可以发现只有两个网络接口。")]),s._v(" "),e("ul",[e("li",[s._v("eth0 实际上是 veth pair 的一端，另一端（veth88f3e3c）连在宿主机的 docker0 网桥上。")]),s._v(" "),e("li",[s._v("lo 就是容器里的本地回环地址。")])]),s._v(" "),e("p",[s._v("接下来修改配置文件 redis.conf，添加绑定 eth0 接口即可，地址为 192.168.42.3。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("bind 127.0.0.1 192.168.42.3\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("配置完成后，在外网就可以通过服务器的公网IP 120.76.207.187 和 6380 端口，映射到容器内的 6379 端口连接 redis。")]),s._v(" "),e("h2",{attrs:{id:"后话"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#后话"}},[s._v("#")]),s._v(" 后话")]),s._v(" "),e("p",[s._v("有不少人会误以为 bind 绑定的 IP 应该是请求来源的 IP。其实不然，绑定的是 redis 服务器本身接受请求的网络接口的 IP 地址。")]),s._v(" "),e("p",[s._v("说到网络接口，就不得不说 Docker 的四种网络方式，之后再整理一篇文章来总结。")])])}),[],!1,null,null,null);n.default=t.exports}}]);