(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{361:function(e,s,n){"use strict";n.r(s);var a=n(4),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h2",{attrs:{id:"前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),n("p",[e._v("今天在封装网络层框架 DKNetworking，更新到 Cocoapods 的时候出现一个错误，核心语句是 "),n("code",[e._v("error: include of non-modular header inside framework module")]),e._v(" ，去到 "),n("a",{attrs:{href:"https://forums.developer.apple.com/thread/23554",target:"_blank",rel:"noopener noreferrer"}},[e._v(" Apple Developer Forums"),n("OutboundLink")],1),e._v(" 发现有很多人有这样的问题，大概是在使用 Swift 的库时会出现这个问题，他们把 Target 下 Build Settings 中 "),n("code",[e._v("Allow Non-modular includes in Framework Modules")]),e._v(" 设为 Yes 就解决了。")]),e._v(" "),n("p",[e._v("但是我依然报错，因为我不是在 Pod install 的时候报错，而是在上传 Pod 的时候 xcodebuild 编译不通过，这个时候的"),n("code",[e._v("Building with xcodebuild")]),e._v("应该是默认的 Xcode 编译环境，不受 Pod 项目本身 Build Settings 的影响，所以改什么都是无用功，最终的解决办法只能从那句 "),n("code",[e._v("pod trunk push")]),e._v(" 入手。")]),e._v(" "),n("h2",{attrs:{id:"错误"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#错误"}},[e._v("#")]),e._v(" 错误")]),e._v(" "),n("p",[e._v("最后的一段错误输出日志如下：")]),e._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("While building module 'DKNetworking' imported from /var/folders/9j/c_9mf_4913z66d00dw_lqwsm0000gn/T/CocoaPods/Lint/App/main.m:3:\nIn file included from <module-includes>:1:\nIn file included from /Users/bingo/Library/Developer/Xcode/DerivedData/App-adpwvlhhgeknoqdfxpvlfodkbype/Build/Products/Release-iphonesimulator/DKNetworking/DKNetworking.framework/Headers/DKNetworking-umbrella.h:19:\n/Users/bingo/Library/Developer/Xcode/DerivedData/App-adpwvlhhgeknoqdfxpvlfodkbype/Build/Products/Release-iphonesimulator/DKNetworking/DKNetworking.framework/Headers/DKNetworkSessionManager.h:9:9: error: include of non-modular header inside framework module 'DKNetworking.DKNetworkSessionManager' [-Werror,-Wnon-modular-include-in-framework-module]\n#import \"AFHTTPSessionManager.h\"\n        ^\n1 error generated.\n/var/folders/9j/c_9mf_4913z66d00dw_lqwsm0000gn/T/CocoaPods/Lint/App/main.m:3:9: fatal error: could not build module 'DKNetworking'\n@import DKNetworking;\n ~~~~~~~^~~~~~~~~~~~\n2 errors generated.\n\n** BUILD FAILED **\n\n\nThe following build commands failed:\n\tCompileC /Users/bingo/Library/Developer/Xcode/DerivedData/App-adpwvlhhgeknoqdfxpvlfodkbype/Build/Intermediates/App.build/Release-iphonesimulator/App.build/Objects-normal/i386/main.o App/main.m normal i386 objective-c com.apple.compilers.llvm.clang.1_0.compiler\n\tCompileC /Users/bingo/Library/Developer/Xcode/DerivedData/App-adpwvlhhgeknoqdfxpvlfodkbype/Build/Intermediates/App.build/Release-iphonesimulator/App.build/Objects-normal/x86_64/main.o App/main.m normal x86_64 objective-c com.apple.compilers.llvm.clang.1_0.compiler\n(2 failures)\n -> DKNetworking (0.1.0)\n    - ERROR | [iOS] xcodebuild: Returned an unsuccessful exit code.\n    - WARN  | [iOS] xcodebuild:  DKNetworking/DKNetworking/DKNetworking.m:362:122: warning: values of type 'NSUInteger' should not be used as format arguments; add an explicit cast to 'unsigned long' instead [-Wformat]\n    - WARN  | xcodebuild:  DKNetworking/DKNetworking/DKNetworking.m:408:25: warning: variable 'downloadTask' is uninitialized when captured by block [-Wuninitialized]\n    - NOTE  | xcodebuild:  DKNetworking/DKNetworking/DKNetworking.m:396:5: note: variable 'downloadTask' is declared here\n    - ERROR | xcodebuild:  /Users/bingo/Library/Developer/Xcode/DerivedData/App-adpwvlhhgeknoqdfxpvlfodkbype/Build/Products/Release-iphonesimulator/DKNetworking/DKNetworking.framework/Headers/DKNetworkSessionManager.h:9:9: error: include of non-modular header inside framework module 'DKNetworking.DKNetworkSessionManager' [-Werror,-Wnon-modular-include-in-framework-module]\n    - NOTE  | xcodebuild:  /var/folders/9j/c_9mf_4913z66d00dw_lqwsm0000gn/T/CocoaPods/Lint/App/main.m:3:9: fatal error: could not build module 'DKNetworking'\n\nAnalyzed 1 podspec.\n\n[!] The spec did not pass validation, due to 2 errors and 2 warnings.\n[!] The validator for Swift projects uses Swift 3.0 by default, if you are using a different version of swift you can use a `.swift-version` file to set the version for your Pod. For example to use Swift 2.3, run: \n    `echo \"2.3\" > .swift-version`.\n\n/Library/Ruby/Gems/2.0.0/gems/cocoapods-1.2.0/lib/cocoapods/command/spec/lint.rb:81:in `run'\n/Library/Ruby/Gems/2.0.0/gems/claide-1.0.1/lib/claide/command.rb:334:in `run'\n/Library/Ruby/Gems/2.0.0/gems/cocoapods-1.2.0/lib/cocoapods/command.rb:52:in `run'\n/Library/Ruby/Gems/2.0.0/gems/cocoapods-1.2.0/bin/pod:55:in `<top (required)>'\n/usr/local/bin/pod:22:in `load'\n/usr/local/bin/pod:22:in `<main>'\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br"),n("span",{staticClass:"line-number"},[e._v("32")]),n("br"),n("span",{staticClass:"line-number"},[e._v("33")]),n("br"),n("span",{staticClass:"line-number"},[e._v("34")]),n("br"),n("span",{staticClass:"line-number"},[e._v("35")]),n("br"),n("span",{staticClass:"line-number"},[e._v("36")]),n("br"),n("span",{staticClass:"line-number"},[e._v("37")]),n("br"),n("span",{staticClass:"line-number"},[e._v("38")]),n("br"),n("span",{staticClass:"line-number"},[e._v("39")]),n("br"),n("span",{staticClass:"line-number"},[e._v("40")]),n("br")])]),n("h2",{attrs:{id:"解决"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#解决"}},[e._v("#")]),e._v(" 解决")]),e._v(" "),n("p",[e._v("解决 warning :")]),e._v(" "),n("div",{staticClass:"language-vim line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vim"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("allow"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("warnings "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" 允许警告，有一些警告是代码自身带的可以忽略\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("解决 error :")]),e._v(" "),n("div",{staticClass:"language-vim line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vim"}},[n("code",[n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("use"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("-")]),e._v("libraries "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" 私有库、静态库引用的时候加上\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("所以最终的解决方法：")]),e._v(" "),n("div",{staticClass:"language-objc line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ pod trunk push --verbose --allow-warnings --use-libraries\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);