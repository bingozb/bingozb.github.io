(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{393:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",[s._v("开始用 ThinkPHP5 框架写 Web 接口，实现对数据库表的增删改查，以及返回 Json 报文。")])]),s._v(" "),a("h2",{attrs:{id:"目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[s._v("#")]),s._v(" 目录结构")]),s._v(" "),a("p",[s._v("首先我们进入用 "),a("code",[s._v("compose create-project")]),s._v(" 创建出来的项目，查看一下目录结构。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("www  WEB部署目录（或者子目录）\n├─application           应用目录\n│  ├─common             公共模块目录（可以更改）\n│  ├─module_name        模块目录\n│  │  ├─common.php      模块函数文件\n│  │  ├─controller      控制器目录\n│  │  ├─model           模型目录\n│  │  ├─view            视图目录\n│  │  ├─config          配置目录\n│  │  └─ ...            更多类库目录\n│  │\n│  ├─command.php        命令行定义文件\n│  ├─common.php         公共函数文件\n│  └─tags.php           应用行为扩展定义文件\n│\n├─config                应用配置目录\n│  ├─module_name        模块配置目录\n│  │  ├─database.php    数据库配置\n│  │  ├─cache           缓存配置\n│  │  └─ ...            \n│  │\n│  ├─app.php            应用配置\n│  ├─cache.php          缓存配置\n│  ├─cookie.php         Cookie配置\n│  ├─database.php       数据库配置\n│  ├─log.php            日志配置\n│  ├─session.php        Session配置\n│  ├─template.php       模板引擎配置\n│  └─trace.php          Trace配置\n│\n├─route                 路由定义目录\n│  ├─route.php          路由定义\n│  └─...                更多\n│\n├─public                WEB目录（对外访问目录）\n│  ├─index.php          入口文件\n│  ├─router.php         快速测试文件\n│  └─.htaccess          用于apache的重写\n│\n├─thinkphp              框架系统目录\n│  ├─lang               语言文件目录\n│  ├─library            框架类库目录\n│  │  ├─think           Think类库包目录\n│  │  └─traits          系统Trait目录\n│  │\n│  ├─tpl                系统模板目录\n│  ├─base.php           基础定义文件\n│  ├─convention.php     框架惯例配置文件\n│  ├─helper.php         助手函数文件\n│  └─logo.png           框架LOGO文件\n│\n├─extend                扩展类库目录\n├─runtime               应用的运行时目录（可写，可定制）\n├─vendor                第三方类库目录（Composer依赖库）\n├─build.php             自动生成定义文件（参考）\n├─composer.json         composer 定义文件\n├─LICENSE.txt           授权说明文件\n├─README.md             README 文件\n├─think                 命令行入口文件\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br")])]),a("p",[s._v("目录非常清晰，可以看得出是 MVC 的架构设计模式，框架就是框架，已经自动生成了很多封装好的代码，我们在开始写业务逻辑代码之前，需要先更改一些配置。")]),s._v(" "),a("h2",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("├─config（应用配置目录）\n│  ├─app.php            应用配置\n│  ├─cache.php          缓存配置\n│  ├─cookie.php         Cookie配置\n│  ├─database.php       数据库配置\n│  ├─log.php            日志配置\n│  ├─session.php        Session配置\n│  ├─template.php       模板引擎配置\n│  ├─trace.php          Trace配置\n│  └─ ...               更多配置文件\n│  \n├─route（路由目录）\n│  ├─route.php          路由定义文件\n│  └─ ...               更多路由定义文件\n│  \n├─application （应用目录）\n│  └─module （模块目录）\n│     └─config（模块配置目录）\n│     \t ├─app.php            应用配置\n│     \t ├─cache.php          缓存配置\n│     \t ├─cookie.php         Cookie配置\n│     \t ├─database.php       数据库配置\n│     \t ├─log.php            日志配置\n│     \t ├─session.php        Session配置\n│     \t ├─template.php       模板引擎配置\n│     \t ├─trace.php          Trace配置\n│  \t └─ ...               更多配置文件\n│  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h3",{attrs:{id:"修改应用配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改应用配置"}},[s._v("#")]),s._v(" 修改应用配置")]),s._v(" "),a("p",[s._v("修改应用配置文件 "),a("code",[s._v("config/app.php")])]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 应用调试模式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'app_debug'")]),s._v("              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean constant"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 默认输出类型")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'default_return_type'")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用注解路由")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'route_annotation'")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean constant"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示错误信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'show_error_msg'")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean constant"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"修改数据库配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改数据库配置"}},[s._v("#")]),s._v(" 修改数据库配置")]),s._v(" "),a("p",[s._v("修改数据库配置文件 "),a("code",[s._v("config/database.php")])]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 服务器地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'hostname'")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'127.0.0.1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 数据库名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'database'")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'demo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 用户名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'username'")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'password'")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 端口")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'hostport'")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'3306'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"创建数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库"}},[s._v("#")]),s._v(" 创建数据库")]),s._v(" "),a("p",[s._v("我们先用 navicat 连接数据库服务，然后新建一个数据库，名称为 "),a("code",[s._v("demo")]),s._v("，字符集选 "),a("code",[s._v("utf-8")]),s._v("。")]),s._v(" "),a("p",[s._v("接着我们建一个用户表 "),a("code",[s._v("user")]),s._v("，添加以下字段：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[s._v("字段")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("类型(长度)")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("描述")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("id")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("int(0)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("用户唯一标识")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("username")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("varchar(32)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("用户名")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("password")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("varchar(32)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("密码")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("name")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("varchar(32)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("姓名")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("gender")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("bit(1)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("性别")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("age")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("int(0)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("年龄")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("mobile")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("int(0)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("手机号码")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("create_time")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("int(0)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("创建时间")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("update_time")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("int(0)")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("更新时间")])])])]),s._v(" "),a("p",[s._v("将 "),a("code",[s._v("id")]),s._v("、"),a("code",[s._v("username")]),s._v("、"),a("code",[s._v("password")]),s._v(" 设为 "),a("code",[s._v("Not Null")]),s._v("，也就是不允许字段值为空。")]),s._v(" "),a("p",[s._v("最后把 "),a("code",[s._v("id")]),s._v(" 设为 "),a("code",[s._v("Key")]),s._v("，也就是主键，并且设置 "),a("code",[s._v("Auto increment")]),s._v("，也就是自动递增。")]),s._v(" "),a("p",[s._v("这样，一张简单的用户表就建好了。")]),s._v(" "),a("h2",{attrs:{id:"开始写代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始写代码"}},[s._v("#")]),s._v(" 开始写代码")]),s._v(" "),a("p",[s._v("MVC 设计模式，M 指的是 model，也就是模型；V 指的是 view，也就是视图层；C 是 controller，也就是控制器。")]),s._v(" "),a("p",[s._v("由于我们只开发 web 接口，不需要做前端页面，所以 view 层是可以去掉的。")]),s._v(" "),a("h3",{attrs:{id:"model"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#model"}},[s._v("#")]),s._v(" Model")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("application/index/")]),s._v(" 下新建一个目录 "),a("code",[s._v("model")]),s._v("，然后在 "),a("code",[s._v("model")]),s._v(" 目录下新建一个 "),a("code",[s._v("User.php")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[s._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("model")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[s._v("think"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Model")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Model")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("这样我们的模型就定义好了。")]),s._v(" "),a("h3",{attrs:{id:"controller"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#controller"}},[s._v("#")]),s._v(" Controller")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("application/index/controller")]),s._v(" 下新建一个 "),a("code",[s._v("User.php")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("namespace")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[s._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("controller")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[s._v("think"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Controller")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[s._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("User")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" UserModel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Controller")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("由于我们新建的数据库还没有添加数据，那么我们先来实现一个用户注册接口。")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @param string $username 用户名\n * @param string $password 密码\n * @return mixed\n * @route('user/register')\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$user")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserModel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'username'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'password'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("save")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("因为我们前面配置的时候已经设置了使用注解路由 "),a("code",[s._v("'route_annotation' => true")]),s._v("，所以原本要通过路由 "),a("code",[s._v("/index/user/register")]),s._v("（模块名/控制器名/操作名），现在只需要 "),a("code",[s._v("/user/register")]),s._v(" 即可。")]),s._v(" "),a("p",[s._v("注意，"),a("code",[s._v("@route('user/register')")]),s._v(" 建议写在注释的最后一行，否则后面还需要一个空行。")]),s._v(" "),a("p",[s._v("这样，访问这个接口，就可以获取到参数，并往数据库"),a("code",[s._v("user")]),s._v("表里插入数据了。")]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/blog/65/postman.jpg",alt:"postman"}})]),s._v(" "),a("p",[s._v("查看数据库表，可以看到已经成功插入了一条数据。")]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/blog/65/user-1.jpg",alt:"user-1"}})]),s._v(" "),a("h2",{attrs:{id:"未完待续……"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#未完待续……"}},[s._v("#")]),s._v(" 未完待续……")])])}),[],!1,null,null,null);t.default=e.exports}}]);